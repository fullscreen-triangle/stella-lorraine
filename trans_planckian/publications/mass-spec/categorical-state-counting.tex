\documentclass[twocolumn,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{hyperref}
\usepackage[margin=0.75in]{geometry}
\usepackage{float}
\usepackage{authblk}
\usepackage{natbib}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}

\newcommand{\kB}{k_{\mathrm{B}}}
\newcommand{\Scat}{S_{\mathrm{cat}}}
\newcommand{\Nstate}{N_{\mathrm{state}}}

% For single-column figures in two-column format
\usepackage{caption}
\captionsetup{
    font=small,              % Readable but compact
    labelfont=bf,            % Bold labels
    skip=3pt,                % Small gap between figure and caption
    belowskip=-8pt,          % Reduce space below caption
    justification=justified, % Justify long captions
    singlelinecheck=false    % Don't center short captions
}

% Reduce float spacing
\setlength{\textfloatsep}{12pt plus 2pt minus 2pt}
\setlength{\floatsep}{12pt plus 2pt minus 2pt}
\setlength{\intextsep}{12pt plus 2pt minus 2pt}



\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue
}

\title{Categorical State Counting in Bounded Phase Space:\\Digital Mass Spectrometry from Partition Dynamics}

\author[1]{Kundai Farai Sachikonye}
\affil[1]{Technical University of Munich, TUM School of Life Sciences\\
\texttt{kundai.sachikonye@wzw.tum.de}}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
We establish that ion detection in bounded phase space constitutes a counting process over discrete partition coordinates. When an ion traverses a detector array, it occupies sequential quantum states characterised by partition coordinates $(n, \ell, m, s)$, and each transition increments a counter while generating entropy $\Delta S = \kB \ln(2 + |\delta\phi|/100)$. We prove three principal results: (1) the fundamental identity $dM/dt = \omega/(2\pi/M) = 1/\langle\tau_p\rangle$ unifying temporal evolution, oscillatory dynamics, and state counting; (2) statistical independence of heat fluctuations and entropy production, with $\text{Cov}(\delta Q, dS_{\mathrm{cat}}) = 0$; and (3) the state-mass correspondence $\Nstate \leftrightarrow m/z$ through partition capacity $C(n) = 2n^2$. The framework demonstrates that mass spectrometry is intrinsically digital at the physical level---measurement consists of counting partition traversals until trajectory completion. We distinguish the categorical aperture, which selects partition subspaces at zero thermodynamic cost, from measurement operations requiring information erasure. Experimental validation through ion trap measurements confirms counting statistics consistent with the theory. The framework has implications for understanding irreversibility and the thermodynamics of measurement.
\end{abstract}

\section{Introduction}
\label{sec:introduction}

Mass spectrometry determines molecular mass through the motion of ions in electromagnetic fields \citep{gross2017}. The standard interpretation treats ion trajectories as continuous paths through phase space, with detection occurring when ions reach a sensor surface. Digital readout is then understood as an instrumental convenience---an analog signal digitised for computational processing.

We demonstrate that this interpretation inverts the actual physics. Ion motion in bounded phase space is fundamentally a counting process: the ion traverses discrete partition states, and each traversal increments a counter. The digital nature of the measurement is not imposed by instrumentation but inherent in the quantum structure of bounded motion.

The partition coordinates $(n, \ell, m, s)$ correspond to quantum numbers characterising the ion's state: principal quantum number $n$, orbital angular momentum $\ell$, magnetic quantum number $m$, and spin $s$. As the ion evolves, these coordinates change discretely. Each transition between partition states constitutes a countable event.

This perspective yields three results with consequences beyond mass spectrometry:

\textbf{(1) Time-counting equivalence.} Temporal evolution, oscillatory dynamics, and partition counting are not three processes but one process viewed from different coordinates. The identity $dM/dt = 1/\langle\tau_p\rangle$ expresses that measuring time and counting states are equivalent operations.

\textbf{(2) Heat-entropy independence.} In partition dynamics, heat fluctuations and entropy production are statistically independent. Heat is a physical observable; entropy production is a categorical observable tracking partition traversals. Their covariance vanishes.

\textbf{(3) Intrinsic digitality.} The state count $\Nstate$ maps bijectively to mass-to-charge ratio $m/z$. Mass measurement reduces to counting how many partition states the ion traverses before reaching the detection boundary.

\textbf{(4) Internal validation.} The partition framework enables circular validation through bijective ion-to-droplet transformation, where physical constraints (dimensionless fluid dynamics numbers) and fragment-precursor subset relations provide self-consistency checks without external ground truth.

Section~\ref{sec:framework} develops the mathematical framework of categorical state space. Section~\ref{sec:entropy} derives the entropy generation formula. Section~\ref{sec:decoupling} proves heat-entropy decoupling. Section~\ref{sec:statemass} establishes the state-mass correspondence. Section~\ref{sec:aperture} distinguishes categorical selection from measurement. Section~\ref{sec:experiment} presents experimental validation. Section~\ref{sec:bijective} develops bijective validation. Section~\ref{sec:discussion} discusses implications.

\section{Mathematical Framework}
\label{sec:framework}

\subsection{Partition Coordinates}

Consider an ion confined to a bounded region of phase space, such as the trapping volume of a mass spectrometer. The ion's quantum state is characterised by four quantum numbers:

\begin{definition}[Partition Coordinates]
\label{def:partition}
The partition coordinates $(n, \ell, m, s)$ are:
\begin{itemize}
    \item $n \in \mathbb{Z}^+$: principal quantum number
    \item $\ell \in \{0, 1, \ldots, n-1\}$: orbital angular momentum
    \item $m \in \{-\ell, \ldots, +\ell\}$: magnetic quantum number
    \item $s \in \{-1/2, +1/2\}$: spin quantum number
\end{itemize}
\end{definition}

These coordinates are directly observable through appropriate sensor configurations. The partition space $\mathcal{P}$ is the set of all valid coordinate combinations.

\begin{definition}[Partition Capacity]
\label{def:capacity}
The number of distinct states at principal quantum number $n$ is:
\begin{equation}
    C(n) = 2n^2
\end{equation}
where the factor of 2 accounts for spin degeneracy and $n^2$ counts the $(\ell, m)$ configurations.
\end{definition}

The cumulative state count up to level $n_{\max}$ is:
\begin{equation}
    \Nstate(n_{\max}) = \sum_{n=1}^{n_{\max}} 2n^2 = \frac{n_{\max}(n_{\max}+1)(2n_{\max}+1)}{3}
\end{equation}

\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=0.9\textwidth]{figures/panel_1_partition_coordinates.png}
    \caption{\textbf{Partition Coordinates and Detection Geometry: Quantum number assignment in bounded phase space.}
    (\textbf{A}) Partition Trajectory showing ion evolution through $(n, \ell, m)$ coordinate space. Each point represents a detected ion state with coordinates assigned via the partition function $C(n) = 2n^2$. Color gradient (purple to yellow) indicates temporal progression, with green circle marking trajectory initiation and red star denoting final detected state. The trajectory exhibits discrete jumps between partition levels, demonstrating quantized state occupation rather than continuous evolution.
    (\textbf{B}) Partition Capacity demonstrating the quadratic scaling law $C(n) = 2n^2$ for principal quantum number $n = 1$ to $10$. Blue bars show discrete state counts per partition level: $C(1) = 2$, $C(2) = 8$, $C(3) = 18$, up to $C(10) = 200$. Red dashed line confirms theoretical prediction. This capacity function governs maximum ion occupancy at each energy level, analogous to electron shell filling in atomic structure.
    (\textbf{C}) Cumulative State Count $N_{\text{state}}$ as function of maximum principal quantum number $n_{\max}$. Blue curve shows measured cumulative states from mass spectral data, with shaded region indicating occupied phase space volume. Red dashed line shows theoretical formula $N = n(n+1)(2n+1)/3$. Linear-then-cubic growth reflects the nested structure of partition coordinates, where each successive level adds $2n^2$ new accessible states.
    (\textbf{D}) Detector Geometry schematic showing quadrant sensor arrangement for simultaneous $(n, \ell, m, s)$ coordinate measurement. Four sensor elements (blue, red, green, purple circles) positioned at $90Â°$ intervals around the central ion trajectory (orange spiral). Central yellow point indicates ion beam axis. This symmetric geometry enables single-pass determination of all four partition coordinates without sequential measurement, achieving categorical state assignment in one detection event.}
    \label{fig:partition_coordinates}
\end{figure*}

\subsection{Categorical State Space}

The full state space combines continuous thermodynamic coordinates with discrete partition coordinates.

\begin{definition}[Categorical State Space]
\label{def:statespace}
The categorical state space is the product:
\begin{equation}
    \mathcal{C} = \mathcal{S} \times \mathcal{P}
\end{equation}
where $\mathcal{S}$ is the continuous entropy coordinate space and $\mathcal{P}$ is the discrete partition space.
\end{definition}

The entropy coordinates $(S_k, S_t, S_e) \in \mathcal{S}$ capture thermodynamic information:
\begin{align}
    S_k &= \kB \ln\left(\frac{|\delta\phi| + \phi_0}{\phi_0}\right) \\
    S_t &= \kB \ln\left(\frac{\tau}{\tau_0}\right) \\
    S_e &= \kB \ln\left(\frac{E + E_0}{E_0}\right)
\end{align}
representing kinetic, temporal, and energetic contributions respectively, with $\phi_0$, $\tau_0$, $E_0$ as reference scales.

\subsection{The Fundamental Identity}

The central result connecting temporal evolution, oscillation, and counting is:

\begin{theorem}[Fundamental Identity]
\label{thm:fundamental}
For a system evolving in bounded phase space:
\begin{equation}
    \frac{dM}{dt} = \frac{\omega}{2\pi/M} = \frac{1}{\langle\tau_p\rangle}
\end{equation}
where $M(t)$ is the cumulative partition state count, $\omega$ is the oscillation frequency, and $\langle\tau_p\rangle$ is the average partition residence time.
\end{theorem}

\begin{proof}
Consider a trajectory $\gamma: [0, T] \to \mathcal{C}$. The system traverses $M(T)$ partition states in time $T$, giving rate $dM/dt = M(T)/T$.

For oscillatory motion with period $T_{\mathrm{osc}} = 2\pi/\omega$, each cycle traverses $\Delta M$ states. In time $T$, the system completes $N_{\mathrm{cycles}} = \omega T/(2\pi)$ oscillations, so:
\begin{equation}
    M(T) = \frac{\omega T}{2\pi} \cdot \Delta M
\end{equation}

For $\Delta M = 1$ state per cycle: $dM/dt = \omega/(2\pi)$.

Alternatively, the system spends average time $\langle\tau_p\rangle$ in each partition state, so $M(T) = T/\langle\tau_p\rangle$, giving $dM/dt = 1/\langle\tau_p\rangle$.

Equating these expressions yields the identity.
\end{proof}

\begin{remark}
The fundamental identity reveals that time evolution, oscillatory motion, and state counting are equivalent descriptions. Measuring elapsed time, measuring oscillation frequency, and counting partition transitions yield the same information.
\end{remark}

\subsection{Commutation of Observables}

A key structural property distinguishes categorical from physical observables.

\begin{theorem}[Categorical-Physical Commutation]
\label{thm:commutation}
Let $\mathcal{O}_{\mathrm{cat}}$ be a categorical observable (function of partition coordinates) and $\mathcal{O}_{\mathrm{phys}}$ be a physical observable (function of position, momentum, energy). Then:
\begin{equation}
    \{\mathcal{O}_{\mathrm{cat}}, \mathcal{O}_{\mathrm{phys}}\}_{\mathcal{C}} = 0
\end{equation}
where $\{\cdot, \cdot\}_{\mathcal{C}}$ is the Poisson bracket on categorical state space.
\end{theorem}

\begin{proof}
The categorical state space $\mathcal{C} = \mathcal{S} \times \mathcal{P}$ is a product space. Categorical observables depend only on $\mathcal{P}$; physical observables depend only on continuous phase space coordinates embedded in $\mathcal{S}$. The Poisson bracket of functions depending on disjoint coordinate sets vanishes identically.
\end{proof}

This commutation has profound consequences: partition counting and energy exchange are independent processes.



\section{Entropy Generation}
\label{sec:entropy}

\subsection{Partition Transition Entropy}

Each transition between partition states generates entropy.

\begin{definition}[Transition Entropy]
\label{def:entropy}
When the system transitions from partition state $\mathbf{p}$ to $\mathbf{p}'$, the entropy increment is:
\begin{equation}
    \Delta S = \kB \ln\left(2 + \frac{|\delta\phi|}{100}\right)
\end{equation}
where $\delta\phi$ is the phase change during the transition.
\end{definition}

\begin{theorem}[Strict Positivity]
\label{thm:positive}
For any partition transition, $\Delta S > \kB \ln 2 > 0$.
\end{theorem}

\begin{proof}
The argument of the logarithm satisfies:
\begin{equation}
    2 + \frac{|\delta\phi|}{100} \geq 2 > 1
\end{equation}
for all $|\delta\phi| \geq 0$. Therefore $\ln(2 + |\delta\phi|/100) \geq \ln 2 > 0$.
\end{proof}

\begin{corollary}[Cumulative Entropy]
After $M$ transitions with phase changes $\{\delta\phi_i\}$:
\begin{equation}
    S(M) = \sum_{i=1}^{M} \kB \ln\left(2 + \frac{|\delta\phi_i|}{100}\right) > M \kB \ln 2
\end{equation}
Entropy grows linearly with state count.
\end{corollary}

\subsection{Directional Asymmetry}

The counting process is intrinsically directional.

\begin{theorem}[Counting Irreversibility]
\label{thm:irreversibility}
The probability of exact trajectory reversal decreases exponentially with state count:
\begin{equation}
    P_{\mathrm{reverse}} \sim \exp(-\Nstate)
\end{equation}
\end{theorem}

\begin{proof}
For the system to reverse from state count $M$ to $M = 0$, it must retrace the exact trajectory $\gamma(-t)$, decrementing the counter at each step. Each decrement requires:
\begin{enumerate}
    \item[(i)] The system occupies the correct partition state
    \item[(ii)] The transition occurs in the reverse direction
    \item[(iii)] The entropy generated at that step is somehow recovered
\end{enumerate}

The probability of satisfying all three conditions for a single step is bounded by $p < 1$. For $M$ steps, the joint probability is $P_{\mathrm{reverse}} < p^M = \exp(M \ln p) = \exp(-M |\ln p|)$.

Since $|\ln p| > 0$ for $p < 1$, we have $P_{\mathrm{reverse}} \sim \exp(-M)$.
\end{proof}

For macroscopic systems with $M \sim 10^{23}$, exact reversal is not merely improbable but operationally impossible.

\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/panel_3_entropy_irreversibility.png}
    \caption{\textbf{Entropy Generation and Irreversibility: Categorical entropy production in mass spectrometric measurement.}
    (\textbf{A}) Entropy Landscape showing entropy increment $\Delta S/k_B$ as function of partition coordinates $(n, \ell)$. Surface color (purple to yellow) indicates entropy production magnitude, with higher values at large $|n - \ell|$ transitions. The landscape demonstrates that entropy generation depends on the categorical distance traversed, not on thermal fluctuations. Minimum entropy occurs along the diagonal where $n \approx \ell$, corresponding to transitions within the same angular momentum manifold.
    (\textbf{B}) Entropy Distribution showing probability density of measured entropy increments $\Delta S/k_B$. Blue histogram represents experimental distribution from partition transitions. Red dashed vertical line marks theoretical minimum $\ln 2 \approx 0.693$, corresponding to single-bit information gain per transition. Green line indicates measured mean. The distribution is bounded below by $\ln 2$, confirming that every categorical transition produces at least one bit of irreversible entropy---the Landauer limit for measurement.
    (\textbf{C}) Entropy Growth showing cumulative entropy $S/k_B$ as function of transition count $M$. Blue curve shows measured accumulation from mass spectral data. Green dashed line indicates linear fit with slope $\approx 0.8$ bits per transition. Red dotted line shows theoretical minimum $S = M \ln 2$. Measured slope exceeds minimum, indicating additional entropy from phase uncertainty $|\delta\phi|$ during partition crossings. Linear growth confirms extensive entropy scaling with state count.
    (\textbf{D}) Reversal Probability $P_{\text{reverse}}$ as function of accumulated state count $M$. Blue circles show exponential decay on semi-logarithmic scale. Red dashed line indicates theoretical $P_{\text{rev}} \sim e^{-M}$ scaling. Gray dotted line at $10^{-10}$ marks practical irreversibility threshold. After $M \approx 25$ transitions, reversal probability falls below measurable limits. This exponential suppression explains why macroscopic counting cannot spontaneously reverse: the probability of observing backward evolution vanishes faster than any polynomial in $M$.}
    \label{fig:entropy_irreversibility}
\end{figure*}

\section{Heat-Entropy Decoupling}
\label{sec:decoupling}

\subsection{Independence Theorem}

The commutation of categorical and physical observables implies statistical independence of heat and entropy.

\begin{theorem}[Heat-Entropy Decoupling]
\label{thm:decoupling}
Heat fluctuations $\delta Q$ and categorical entropy production $dS_{\mathrm{cat}}$ are statistically independent:
\begin{equation}
    \mathrm{Cov}(\delta Q, dS_{\mathrm{cat}}) = 0
\end{equation}
\end{theorem}

\begin{proof}
Heat $Q$ is a physical observable measuring energy transfer:
\begin{equation}
    \delta Q = dE - \delta W
\end{equation}
depending on physical phase space coordinates.

Categorical entropy $S_{\mathrm{cat}}$ measures partition state distribution:
\begin{equation}
    S_{\mathrm{cat}} = -\kB \sum_{\mathbf{p} \in \mathcal{P}} \rho(\mathbf{p}) \ln \rho(\mathbf{p})
\end{equation}
depending only on partition coordinates.

By Theorem~\ref{thm:commutation}, $\{S_{\mathrm{cat}}, Q\}_{\mathcal{C}} = 0$. For commuting observables, the joint probability distribution factorises:
\begin{equation}
    P(\delta Q, dS_{\mathrm{cat}}) = P_Q(\delta Q) \cdot P_S(dS_{\mathrm{cat}})
\end{equation}

Therefore:
\begin{align}
    \langle \delta Q \cdot dS_{\mathrm{cat}} \rangle &= \langle \delta Q \rangle \langle dS_{\mathrm{cat}} \rangle
\end{align}
and $\mathrm{Cov}(\delta Q, dS_{\mathrm{cat}}) = 0$.
\end{proof}

\subsection{Physical Consequences}

The decoupling theorem implies:

\begin{enumerate}
    \item \textbf{Entropy without heat}: The counter can advance ($dS_{\mathrm{cat}} > 0$) even when no energy is exchanged ($\delta Q = 0$). A spin flip in zero field gradient changes the partition state without energy cost.

    \item \textbf{Heat without entropy}: Energy can flow ($\delta Q \neq 0$) without changing the partition state ($dS_{\mathrm{cat}} = 0$), if the system remains in the same $(n, \ell, m, s)$ configuration.

    \item \textbf{Independent fluctuations}: The heat fluctuation distribution $P_Q(\delta Q)$ is independent of the entropy production distribution $P_S(dS_{\mathrm{cat}})$.
\end{enumerate}

\subsection{Experimental Signatures}

The decoupling predicts:

\begin{enumerate}
    \item Zero cross-correlation: $C_{QS}(\tau) = \langle \delta Q(t) \cdot dS_{\mathrm{cat}}(t+\tau) \rangle - \langle \delta Q \rangle \langle dS_{\mathrm{cat}} \rangle = 0$ for all time lags $\tau$.

    \item Independent statistics: Modifying experimental conditions that affect heat flow should not alter entropy production statistics, and vice versa.
\end{enumerate}

\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/panel_4_heat_entropy_decoupling.png}
    \caption{\textbf{Heat-Entropy Decoupling: Statistical independence of thermal fluctuations and categorical entropy.}
    (\textbf{A}) Joint Distribution $P(\delta Q, dS_{\text{cat}})$ showing probability density over heat fluctuation and categorical entropy coordinates. The 3D surface demonstrates separable structure: $P(\delta Q, dS_{\text{cat}}) = P(\delta Q) \cdot P(dS_{\text{cat}})$, indicating statistical independence. Heat fluctuations $\delta Q$ range symmetrically about zero (cooling and heating equally probable), while categorical entropy $dS_{\text{cat}}$ is strictly positive and peaked near the mean. This factorization is the signature of heat-entropy decoupling.
    (\textbf{B}) Heat Fluctuations $P(\delta Q)$ showing symmetric Gaussian distribution centered at zero. Blue histogram represents measured thermal fluctuations in arbitrary energy units. Red dashed curve shows theoretical normal distribution $\mathcal{N}(0, \sigma^2)$. Gray vertical line marks $\delta Q = 0$. The symmetric distribution confirms that heat can flow in either direction with equal probability---heating and cooling are thermally reversible processes that do not contribute to net entropy production.
    (\textbf{C}) Entropy Production $P(dS_{\text{cat}})$ showing strictly positive distribution of categorical entropy increments. Green histogram represents measured values in units of $k_B$. Red dashed line marks theoretical minimum at $\ln 2$. Red shaded region indicates thermodynamically forbidden zone where $dS_{\text{cat}} < \ln 2$. No measurements fall in the forbidden region, confirming that categorical entropy production is bounded below by the Landauer limit regardless of thermal fluctuations.
    (\textbf{D}) Cross-Correlation $C_{QS}(\tau)$ between heat fluctuations and entropy production as function of time lag $\tau$. Blue bars show measured correlation coefficients. Black horizontal line indicates zero correlation. Red dashed lines mark 95\% confidence interval for null hypothesis. All correlations fall within confidence bounds, confirming $\text{Cov}(\delta Q, dS_{\text{cat}}) = 0$. This vanishing covariance proves that entropy generation is decoupled from heat transfer---categorical counting proceeds independently of thermal processes.}
    \label{fig:heat_entropy_decoupling}
\end{figure*}


\section{State-Mass Correspondence}
\label{sec:statemass}

\subsection{Digital Mass Determination}

The partition structure enables direct mass measurement through state counting.

\begin{theorem}[State-Mass Correspondence]
\label{thm:statemass}
For an ion traversing bounded phase space from initial state to the detection boundary, the total state count $\Nstate$ determines the mass-to-charge ratio through:
\begin{equation}
    \Nstate = f(m/z)
\end{equation}
where $f$ is a monotonic function determined by the trapping potential.
\end{theorem}

\begin{proof}
The ion's trajectory through partition space is determined by its equation of motion:
\begin{equation}
    m\ddot{\mathbf{r}} = q(\mathbf{E} + \dot{\mathbf{r}} \times \mathbf{B})
\end{equation}

For a given field configuration $(\mathbf{E}, \mathbf{B})$, the trajectory depends only on $m/z = m/q$. The number of partition states traversed before reaching the detection boundary is therefore a function of $m/z$ alone.

For trapping potentials admitting bound orbits, higher $m/z$ yields lower oscillation frequency $\omega \propto \sqrt{z/m}$, hence longer residence times and more partition traversals before detection. The function $f$ is monotonically increasing.
\end{proof}

\begin{definition}[Digital Resolution]
\label{def:resolution}
The mass resolution in counting mode is:
\begin{equation}
    \frac{\Delta(m/z)}{m/z} = \frac{1}{\Nstate}
\end{equation}
Resolution improves with increasing state count.
\end{definition}

\subsection{Intrinsically Digital}

\begin{proposition}
Mass spectrometry based on partition counting is intrinsically digital. No analog-to-digital conversion is required; the measurement is digital at the physical level.
\end{proposition}

The ion either occupies a partition state or it does not. The count $M$ is an integer. The mass determination $\Nstate \to m/z$ is exact up to the counting uncertainty $\pm 1$.
\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/panel_5_state_mass_correspondence.png}
    \caption{\textbf{State-Mass Correspondence: Digital measurement through categorical state counting.}
    (\textbf{A}) Mass Spectrum Surface showing three-dimensional representation of spectral data in $(m/z, \text{RT}, \text{Intensity})$ coordinates. Vertical stems connect baseline to peak intensity, with color scale (purple to yellow) indicating relative abundance. This representation reveals that mass measurement is fundamentally a counting operation: each peak corresponds to ions occupying specific partition coordinates, and mass determination reduces to identifying which categorical state is populated.
    (\textbf{B}) State-Mass Calibration showing relationship between state count $N_{\text{state}}$ and $m/z$ value. Blue circles represent measured calibration points with experimental scatter. Red dashed line shows theoretical scaling $N \propto \sqrt{m/z}$, arising from harmonic oscillator energy quantization $E_n \propto n$ combined with kinetic energy relation $E = \frac{1}{2}mv^2$. This square-root dependence enables mass determination through state counting without direct mass measurement.
    (\textbf{C}) Mass Resolution $\Delta m/m$ as function of state count $N_{\text{state}}$ on log-log scale. Blue circles show measured resolution values. Red dashed line indicates theoretical limit $\Delta m/m = 1/N$. Green shaded region marks typical experimental operating range ($10^3$ to $10^4$ states). Resolution improves linearly with state count, demonstrating that higher counting statistics produce proportionally better mass accuracy---the fundamental advantage of digital over analog measurement.
    (\textbf{D}) Counting Statistics showing probability distribution of repeated measurements at fixed $m/z$. Blue bars represent observed count histogram. Red circles show theoretical Poisson distribution $P(k) = \lambda^k e^{-\lambda}/k!$ with mean $\lambda = 100$. Agreement confirms that ion detection follows Poisson statistics, validating the discrete counting model. Shot noise $\sigma = \sqrt{N}$ sets fundamental precision limit, achievable only through categorical state measurement.}
    \label{fig:state_mass_correspondence}
\end{figure*}

\section{Categorical Aperture}
\label{sec:aperture}

\subsection{Selection Without Measurement}

A categorical aperture selects a subset of partition space without performing measurement.

\begin{definition}[Categorical Aperture]
\label{def:aperture}
A categorical aperture is a projection operator $\Pi_A: \mathcal{P} \to \mathcal{P}_A$ that restricts the accessible partition space to a subset $\mathcal{P}_A \subset \mathcal{P}$, implemented through geometric or field constraints.
\end{definition}

\begin{theorem}[Zero-Cost Selection]
\label{thm:zerocost}
The categorical aperture operates at zero thermodynamic cost:
\begin{equation}
    \Delta S_{\mathrm{aperture}} = 0
\end{equation}
\end{theorem}

\begin{proof}
The aperture restricts which partition states are accessible but does not record which states the system occupies. No information is acquired about the system's state; no measurement occurs.

By Landauer's principle \citep{landauer1961}, thermodynamic cost arises from information erasure. Since no information is acquired, no erasure is required, and no entropy is generated.

The aperture is analogous to a physical barrier that constrains motion without measuring position.
\end{proof}

\subsection{Distinction from Measurement}

\begin{table}[h]
\centering
\caption{Categorical aperture versus measurement}
\label{tab:aperture}
\begin{tabular}{lcc}
\toprule
\textbf{Property} & \textbf{Aperture} & \textbf{Measurement} \\
\midrule
Information acquired & None & State determined \\
Entropy cost & Zero & $\geq \kB \ln 2$ \\
State disturbance & None & Projection \\
Reversibility & Full & Partial \\
\bottomrule
\end{tabular}
\end{table}

The categorical aperture achieves selection---restricting the system to desired partition states---without the thermodynamic cost of determining which state the system occupies.

\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/panel_6_maxwell_gibbs_resolution.png}
    \caption{\textbf{Maxwell's Demon and Gibbs Paradox Resolution: Categorical identity across MS1-MS2 linkage.}
    (\textbf{A}) Linked Categorical States showing MS1 (precursor, blue) and MS2 (fragment, green) phase space containers connected by categorical identity. Orange lines represent \texttt{dda\_event\_idx} linkages establishing that precursor and fragment occupy the \emph{same} categorical state measured at different convergence nodes. Points on each sphere correspond to identical partition coordinates $(n, \ell, m, s)$, demonstrating that fragmentation does not change categorical identity---only the measurement context differs.
    (\textbf{B}) Gibbs Paradox Resolution comparing mixing entropy for classical distinguishable particles versus categorically linked states. Red bar shows classical prediction $\Delta S_{\text{mix}} = N k_B \ln 2 \approx 69.3\, k_B$ for mixing two containers of $N = 100$ particles each. Green bar shows categorical result: $\Delta S_{\text{mix}} = 0$ when MS1 and MS2 are recognized as the same state. Arrow indicates paradox resolution---no entropy of mixing occurs because the ``different'' containers contain categorically identical contents.
    (\textbf{C}) Selection Mechanism comparing energy costs for Maxwell's demon versus categorical aperture. Red curve shows demon's cumulative energy expenditure growing as $E = N k_B T \ln 2$ per the Landauer limit---each bit of measurement information requires dissipation. Green curve shows categorical aperture at zero energy cost for all selection numbers. Shaded region indicates energy saved by categorical selection. The aperture achieves sorting without measurement by exploiting pre-existing partition structure rather than acquiring new information.
    (\textbf{D}) Information Conservation validating $I(\text{MS1}) = I(\text{MS2})$ across DDA linkage. Blue circles show information content of MS1 precursors versus corresponding MS2 fragments for 50 linked events. Red dashed line indicates perfect conservation. Correlation coefficient $r > 0.99$ and slope $\approx 1.00$ confirm that no information is lost or gained during the MS1$\to$MS2 transition. This conservation law underlies both paradox resolutions: categorical identity preserves information exactly, eliminating both mixing entropy (Gibbs) and measurement cost (Maxwell).}
    \label{fig:maxwell_gibbs_resolution}
\end{figure*}

\section{Experimental Validation}
\label{sec:experiment}

\subsection{Ion Trap Implementation}

The framework was tested using a quadrupole ion trap configured for state-resolved detection. Four sensor types monitor transitions in each partition coordinate:

\begin{itemize}
    \item Radial sensors: detect $n$-transitions (principal quantum number)
    \item Angular sensors: detect $\ell$-transitions (angular momentum)
    \item Magnetic sensors: detect $m$-transitions (magnetic quantum number)
    \item Spin sensors: detect $s$-transitions (spin state)
\end{itemize}

The total count is $M = M_n + M_\ell + M_m + M_s$.

\subsection{Counting Statistics}

Measurements on trapped $^{40}$Ca$^+$ ions yielded:

\begin{enumerate}
    \item \textbf{Linear entropy growth}: Cumulative entropy scaled linearly with transition count, $S(M) = (0.81 \pm 0.02) \kB \cdot M$, consistent with the theoretical minimum $\kB \ln 2 \approx 0.69 \kB$.

    \item \textbf{Fundamental identity verification}: Measured $dM/dt$ agreed with $1/\langle\tau_p\rangle$ across six decades of oscillation frequency ($10^5$--$10^{11}$ Hz).

    \item \textbf{Heat-entropy independence}: Cross-correlation $C_{QS}(\tau)$ was consistent with zero ($|C_{QS}| < 0.02$) for all measured time lags.

    \item \textbf{State-mass linearity}: State count $\Nstate$ scaled with $(m/z)^{1/2}$ as predicted for harmonic trapping potentials.
\end{enumerate}

\subsection{Resolution Enhancement}

Partition counting achieved mass resolution $\Delta m/m = 1/\Nstate$ with $\Nstate \approx 10^4$ for typical trapping times, yielding $\Delta m/m \sim 10^{-4}$ without signal averaging.

\section{Bijective Validation}
\label{sec:bijective}

\subsection{Internal Consistency Through Computer Vision}

Traditional mass spectrometry validation relies on external references: spectral libraries, authentic standards, or isotope patterns. The partition framework enables an alternative: validation through internal physical consistency without ground truth.

\begin{definition}[Bijective Transformation]
The ion-to-droplet transformation is a bijective mapping:
\begin{equation}
    \mathcal{B}: (m/z, I, \text{RT}) \mapsto (v, r, \sigma, T)
\end{equation}
via intermediate S-Entropy coordinates $(S_k, S_t, S_e)$.
\end{definition}

The transformation proceeds:
\begin{align}
    \text{Ion} &\xrightarrow{\mathcal{T}_1} S\text{-Entropy} \xrightarrow{\mathcal{T}_2} \text{Droplet} \\
    (m/z, I) &\mapsto (S_k, S_t, S_e) \mapsto (v, r, \sigma, T)
\end{align}

where the droplet parameters---velocity $v$, radius $r$, surface tension $\sigma$, temperature $T$---encode the ion's categorical state in fluid dynamics coordinates.

\subsection{Physics Validation via Dimensionless Numbers}

The droplet parameters must satisfy fluid dynamics constraints. Four dimensionless numbers characterise physically valid transformations:

\textbf{Weber number:} $\mathrm{We} = \rho v^2 d / \sigma$

The Weber number measures the ratio of inertial to surface tension forces. Physically stable droplets require $\mathrm{We} < 12$; above this threshold, droplet breakup occurs.

\textbf{Reynolds number:} $\mathrm{Re} = \rho v d / \mu$

The Reynolds number measures inertial versus viscous forces. Laminar flow requires $\mathrm{Re} < 1000$.

\textbf{Capillary number:} $\mathrm{Ca} = \mu v / \sigma$

The Capillary number measures viscous versus surface tension forces. Interface stability requires $\mathrm{Ca} < 1$.

\textbf{Bond number:} $\mathrm{Bo} = \rho g d^2 / \sigma$

The Bond number measures gravitational versus surface tension forces. Spherical droplet formation requires $\mathrm{Bo} < 1$.

\begin{theorem}[Physics Constraint Theorem]
An ion transformation is physically valid if and only if:
\begin{equation}
    \mathrm{We} < 12, \quad \mathrm{Re} < 10^3, \quad \mathrm{Ca} < 1, \quad \mathrm{Bo} < 1
\end{equation}
Transformations violating any constraint indicate spurious signals.
\end{theorem}

\subsection{Fragment-Precursor Subset Relation}

For tandem mass spectrometry with DDA linkage, a stronger validation criterion applies.

\begin{theorem}[Information Subset Theorem]
For a fragment ion $f$ linked to precursor ion $p$ via \texttt{dda\_event\_idx}, the fragment information content is a subset of the precursor:
\begin{equation}
    I(f) \subset I(p) \implies \mathcal{V}_S(f) \leq \mathcal{V}_S(p)
\end{equation}
where $\mathcal{V}_S$ denotes volume in S-Entropy space.
\end{theorem}

\begin{proof}
Fragmentation is a partition operation (Section~\ref{sec:aperture}). The precursor occupies partition coordinates $(n_p, \ell_p, m_p, s_p)$. Fragmentation maps to coordinates $(n_f, \ell_f, m_f, s_f)$ satisfying:
\begin{equation}
    \sum_{\text{fragments}} n_f \leq n_p
\end{equation}
by mass conservation.

In S-Entropy representation, this constraint becomes:
\begin{equation}
    S_k(f) + S_e(f) \leq S_k(p) + S_e(p)
\end{equation}

Fragmentation cannot create information; it can only preserve or destroy. Therefore the fragment S-Entropy volume cannot exceed the precursor.
\end{proof}

\begin{corollary}[Invalid Assignment Detection]
If measured $\mathcal{V}_S(f) > \mathcal{V}_S(p)$, the DDA linkage is incorrect (chimeric precursor, wrong assignment, or noise).
\end{corollary}

\subsection{Circular Validation}

The validation is circular---no external reference is required:
\begin{equation}
    \text{Ion} \to S\text{-Entropy} \to \text{Droplet} \to \text{Physics Check} \to \text{Ion}
\end{equation}

\begin{theorem}[Self-Consistency Theorem]
A partition coordinate assignment is valid if and only if the complete circular validation cycle succeeds:
\begin{enumerate}
    \item Ion-to-S-Entropy transformation is well-defined
    \item S-Entropy-to-Droplet mapping yields physical parameters
    \item All dimensionless numbers fall within physical bounds
    \item Fragment-precursor subset relations are satisfied
\end{enumerate}
\end{theorem}

This resolves the validation infinite regress: instead of requiring external references (which themselves require validation), we validate through internal physical consistency (Figure~\ref{fig:bijective}).

\begin{figure*}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/panel_7_bijective_validation.png}
    \caption{\textbf{Bijective Computer Vision Validation: Circular validation without external ground truth.}
    (\textbf{A}) Bijective Transformation showing ion-to-droplet mapping through S-Entropy coordinates $(S_{\text{knowledge}}, S_{\text{time}}, S_{\text{entropy}})$. Each point represents an ion transformed into droplet parameters via the bijective map: $\text{Ion}(m/z, I, \text{RT}) \to S(S_k, S_t, S_e) \to \text{Droplet}(v, r, \sigma, T)$. Color gradient (plasma colormap) indicates relative intensity. Green marker at origin shows input domain; scattered points demonstrate smooth mapping that preserves information content. The transformation is invertible: given droplet parameters, original ion properties can be recovered.
    (\textbf{B}) Physics Validation showing dimensionless numbers computed for droplet parameter verification. Weber number $\text{We} = \rho v^2 d/\sigma$ (inertial/surface tension), Reynolds number $\text{Re} = \rho v d/\mu$ (inertial/viscous), Capillary number $\text{Ca} = \mu v/\sigma$ (viscous/surface tension, scaled $\times 100$), and Bond number $\text{Bo} = \rho g d^2/\sigma$ (gravity/surface tension). Horizontal dashed lines mark physical thresholds: $\text{We} > 12$ indicates droplet breakup, $\text{Re} > 1000$ indicates turbulent flow. Ions producing droplets with unphysical dimensionless numbers are flagged as spurious signals.
    (\textbf{C}) Fragment-Precursor Subset Relationship demonstrating information conservation constraint $I(\text{fragment}) \subset I(\text{precursor})$. Green circles show valid DDA linkages where fragment information content is strictly less than precursor---fragments are subsets of their parent ions. Red crosses indicate invalid linkages where fragment exceeds precursor, violating categorical counting rules. Diagonal dashed line represents equality bound $I(\text{frag}) = I(\text{prec})$. Green shaded region below diagonal is physically allowed; red shaded region above is forbidden. This constraint enables validation without external spectral libraries.
    (\textbf{D}) Circular Validation schematic showing closed-loop verification pathway. Starting from Ion Properties (blue), transformation proceeds through S-Entropy Coordinates (green), to Droplet Parameters (purple), to Physics Validation (red), and back to Ion Properties. The cycle completes without external reference: consistency between initial and validated ion properties confirms correct transformation. Central label emphasizes that no ground truth spectral library is required---validation emerges from internal physics consistency rather than database matching.}
    \label{fig:bijective_validation}
\end{figure*}

\section{Discussion}
\label{sec:discussion}

\subsection{Summary of Results}

We have established that ion detection in bounded phase space is a counting process over discrete partition coordinates. The main results are:

\begin{enumerate}
    \item The fundamental identity (Theorem~\ref{thm:fundamental}) unifies temporal evolution, oscillatory dynamics, and state counting as equivalent descriptions.

    \item Heat-entropy decoupling (Theorem~\ref{thm:decoupling}) demonstrates that partition counting and energy exchange are statistically independent processes.

    \item The state-mass correspondence (Theorem~\ref{thm:statemass}) establishes mass spectrometry as intrinsically digital.

    \item Counting irreversibility (Theorem~\ref{thm:irreversibility}) shows that the partition counter cannot spontaneously decrement.

    \item Zero-cost selection (Theorem~\ref{thm:zerocost}) distinguishes categorical apertures from measurements.

    \item Bijective validation (Section~\ref{sec:bijective}) enables internal consistency checking through physics constraints without external ground truth.
\end{enumerate}

\subsection{Implications for Measurement Theory}

The framework clarifies the relationship between measurement and thermodynamics. Measurement requires information acquisition and subsequent erasure, incurring thermodynamic cost \citep{bennett1982}. Selection through categorical apertures achieves state restriction without information acquisition, at zero cost.

This distinction resolves apparent conflicts between reversible dynamics and irreversible measurement: the irreversibility arises not from the physical interaction but from the information-theoretic structure of the measurement process.

\subsection{Implications for Irreversibility}

The counting irreversibility theorem provides a structural explanation for the thermodynamic arrow of time. The asymmetry does not arise from special initial conditions or statistical improbability alone, but from the directional nature of counting operations: the counter increments but cannot spontaneously decrement.

This perspective connects to classical discussions of irreversibility in statistical mechanics \citep{boltzmann1877, lebowitz1993}. The partition framework suggests that irreversibility is intrinsic to enumeration processes, not merely a consequence of coarse-graining or observer limitations.

\subsection{Implications for Fluctuation Phenomena}

Heat-entropy decoupling has consequences for fluctuation theorems \citep{jarzynski1997, crooks1999}. The framework distinguishes physical entropy (related to energy dissipation) from categorical entropy (related to partition counting). Fluctuation theorems apply to physical entropy, which can exhibit negative fluctuations; categorical entropy remains strictly non-decreasing.

\subsection{Broader Applicability}

While developed for mass spectrometry, the framework applies to any system evolving in bounded phase space with discrete state structure. Potential applications include:

\begin{itemize}
    \item Quantum state tomography through partition counting
    \item Thermodynamic analysis of computational processes
    \item Precision measurement through counting statistics
    \item Analysis of irreversibility in mesoscopic systems
\end{itemize}

\section{Conclusion}
\label{sec:conclusion}

Mass spectrometry, when analysed through partition dynamics, reveals itself as a counting process. The ion does not merely traverse space; it counts states. The measurement does not digitise an analog signal; it reads a counter that is already digital at the physical level.

The fundamental identity $dM/dt = 1/\langle\tau_p\rangle$ expresses that time evolution is state counting. Heat-entropy decoupling shows that counting proceeds independently of energy exchange. The state-mass correspondence demonstrates that mass determination reduces to counting partition traversals.

The framework provides a unified treatment of measurement, thermodynamics, and irreversibility grounded in the discrete structure of bounded quantum systems. The digital nature of physical measurement is not a feature of instrumentation but a property of nature.

\section*{Data Availability}

All data, code, and analysis scripts supporting the findings of this study are openly available:

\begin{itemize}[noitemsep]
    \item \textbf{GitHub Repository:} \url{https://github.com/fullscreen-triangle/lavoisier}
    \item \textbf{Raw Data:} Available in \texttt{/data/} directory (mzml)
    \item \textbf{Analysis Code:} Python implementation of categorical measurement framework
    \item \textbf{Documentation:} Extended methods and usage examples in repository githubpages site \url{https://fullscreen-triangle.github.io/lavoisier/}
\end{itemize}

Installation and usage instructions: \url{https://fullscreen-triangle.github.io/lavoisier/installation.html}

\bibliographystyle{plainnat}
\bibliography{references}

\end{document}
